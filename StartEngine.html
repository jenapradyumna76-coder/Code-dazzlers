<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECOSECURE File Wipe & Report</title>
    <style>
        :root { --danger: #e53e3e; --success: #38a169; --bg: #f7fafc; }
        body { font-family: 'Inter', system-ui, sans-serif; background: var(--bg); padding: 20px; color: #2d3748; }
        .container { max-width: 700px; margin: 40px auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        
        /* Upload UI */
        .upload-box { border: 2px dashed #cbd5e0; padding: 40px; text-align: center; border-radius: 12px; cursor: pointer; background: #fff; transition: 0.2s; }
        .upload-box:hover { border-color: #4299e1; background: #ebf8ff; }
        
        /* Progress Bar */
        #wipeProgressContainer { width: 100%; background: #edf2f7; border-radius: 10px; height: 12px; margin: 20px 0; display: none; overflow: hidden; }
        #wipeBar { height: 100%; width: 0%; background: var(--danger); transition: width 0.1s linear; }

        /* Report Table */
        .report-table { width: 100%; border-collapse: collapse; margin-top: 20px; display: none; animation: fadeIn 0.5s ease-in; }
        .report-table th, .report-table td { padding: 12px; border: 1px solid #e2e8f0; text-align: left; }
        .report-table th { background: #f8fafc; color: #64748b; font-size: 0.8em; text-transform: uppercase; }
        .status-destroyed { color: var(--danger); font-weight: bold; font-size: 0.8em; }

        /* Buttons */
        .btn-destroy { background: #1a202c; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: 600; margin-top: 20px; }
        .btn-destroy:hover { background: #000; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <h2 style="margin-top:0;">Secure Session Wipe</h2>
    <p style="color: #718096;">Upload multiple files or folders. Use the destruction tool to purge them from the browser memory.</p>

    <div class="upload-box" onclick="document.getElementById('fileInput').click()">
        <strong>Click to select Files or Folders</strong>
        <input type="file" id="fileInput" multiple webkitdirectory mozdirectory style="display:none;">
        <p id="fileCountText" style="margin-top:10px; font-size: 0.9em; color: #a0aec0;">No files selected</p>
    </div>

    <div id="actionArea" style="display:none;">
        <button class="btn-destroy" onclick="startDestruction()">PURGE DATA FROM MEMORY</button>
    </div>

    <div id="wipeProgressContainer">
        <div id="wipeBar"></div>
    </div>

    <div id="reportContainer" class="report-table">
        <h3 style="color: var(--danger);">Destruction Report</h3>
        <table>
            <thead>
                <tr>
                    <th>Metric</th>
                    <th>Details</th>
                </tr>
            </thead>
            <tbody id="reportData">
                </tbody>
        </table>
        <p style="font-size: 0.8em; color: #718096; margin-top: 15px;">Note: File references were overwritten and garbage-collected.</p>
        <button onclick="location.reload()" style="background:none; border: 1px solid #ccc; padding: 5px 10px; border-radius: 4px; cursor: pointer;">Reset App</button>
    </div>
</div>

<script>
    int main() {
    string filePath;
    cout << "========================================" << endl;
    cout << "      ECO-SECURE SHREDDING ENGINE       " << endl;
    cout << "========================================" << endl;
    cout << "Enter filename to securely wipe: ";
    cin >> filePath;

    // 1. Open file to check size
    ifstream inFile(filePath, ios::binary | ios::ate);
    if (!inFile) {
        cout << "Error: File not found!" << endl;
        return 1;
    }
    long size = inFile.tellg();
    inFile.close();

    // 2. Perform Overwrite (The "Shredding")
    cout << "Shredding " << filePath << " (" << size << " bytes)..." << endl;
    
    ofstream outFile(filePath, ios::binary);
    for (int pass = 1; pass <= 3; pass++) {
        cout << "Pass " << pass << "/3..." << endl;
        outFile.seekp(0);
        for (int i = 0; i < size; i++) {
            char junk = (pass == 1) ? 0 : (pass == 2) ? 0xFF : rand() % 256;
            outFile.put(junk);
        }
    }
    outFile.close();

    // 3. Delete the file
    if (remove(filePath.c_str()) == 0) {
        cout << "SUCCESS: File physically removed from disk." << endl;
        generateReport(filePath, size); // Create the Visual Report
        cout << "Audit Report Generated: VisualReport.html" << endl;
    } else {
        cout << "Error deleting file." << endl;
    }

    cout << "\nPress Enter to exit...";
    cin.ignore();
    cin.get();
    return 0;
}
// After the file is destroyed...
ofstream report("VisualReport.html"); 
report << "<html><body><h1>File Securely Destroyed</h1></body></html>";
report.close();

 generateReport(string fileName, long fileSize)
 {
    ofstream report("VisualReport.html");
    time_t now = time(0);
    char* dt = ctime(&now);

    report << "<html><head><style>"
           << "body { font-family: sans-serif; background: #f0f2f5; display: flex; justify-content: center; padding: 40px; }"
           << ".card { background: white; border-top: 10px solid #2e7d32; padding: 30px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); width: 500px; }"
           << ".status { color: #2e7d32; font-weight: bold; text-transform: uppercase; }"
           << "hr { border: 0; border-top: 1px solid #eee; margin: 20px 0; }"
           << "</style></head><body>"
           << "<div class='card'>"
           << "<h2>♻️ Eco-Secure Audit Report</h2>"
           << "<p class='status'>✅ Method: Secure Cryptographic Wipe</p>"
           << "<hr>"
           << "<p><strong>File Destroyed:</strong> " << fileName << "</p>"
           << "<p><strong>File Size:</strong> " << fileSize << " bytes</p>"
           << "<p><strong>Timestamp:</strong> " << dt << "</p>"
           << "<p><strong>Passes:</strong> 3-Pass Overwrite (0x00, 0xFF, Random)</p>"
           << "<hr>"
           << "<p style='font-size: 0.8em; color: #666;'>This document serves as digital proof of data sanitization.</p>"
           << "</div></body></html>";
    
    report.close();
}
</script>

</body>
</html>
